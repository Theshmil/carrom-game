<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Carrom Pool</title>
<style>
  body {
    margin: 0;
    background: #222;
    font-family: sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    margin: 10px;
  }
  canvas {
    background: url('https://i.imgur.com/hvXNs9g.jpg'); /* Wooden texture */
    background-size: cover;
    border: 5px solid #fff;
    border-radius: 20px;
    touch-action: none;
  }
  #menu {
    margin: 10px;
  }
  #menu button {
    margin: 5px;
    padding: 10px 20px;
    font-size: 18px;
    background: #444;
    color: #fff;
    border: none;
    border-radius: 8px;
  }
  #powerSlider {
    width: 200px;
    margin: 10px;
  }
  #winMessage {
    position: absolute;
    top: 40%;
    background: rgba(0,0,0,0.8);
    padding: 20px;
    border-radius: 10px;
    font-size: 24px;
    display: none;
  }
</style>
</head>
<body>

<h1>Carrom Pool</h1>
<div id="menu">
  <button onclick="restartGame()">Restart</button>
  <label>Power:
    <input type="range" id="powerSlider" min="5" max="20" value="10">
  </label>
</div>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<div id="winMessage">ðŸŽ‰ You Win! <button onclick="restartGame()">Play Again</button></div>

<audio id="strikeSound" src="https://www.myinstants.com/media/sounds/button-10.mp3"></audio>
<audio id="pocketSound" src="https://www.myinstants.com/media/sounds/metal-clank.mp3"></audio>
<audio id="winSound" src="https://www.myinstants.com/media/sounds/success-fanfare-trumpets.mp3"></audio>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let striker = {x: 200, y: 360, r: 10, vx: 0, vy: 0};
let pucks = [];
let dragging = false;
let dragStart = null;
let power = 10;
const powerSlider = document.getElementById('powerSlider');
powerSlider.oninput = () => { power = parseInt(powerSlider.value); }

function initPucks() {
  pucks = [];
  const positions = [
    {x: 200, y: 200}, {x: 215, y: 200}, {x: 185, y: 200},
    {x: 200, y: 215}, {x: 200, y: 185}, {x: 215, y: 215},
    {x: 185, y: 185}, {x: 215, y: 185}, {x: 185, y: 215},
    {x: 200, y: 170}
  ];
  for (let i=0; i<positions.length; i++) {
    pucks.push({x: positions[i].x, y: positions[i].y, r:8, color: i==0?'red': (i%2==0?'white':'black'), vx:0, vy:0});
  }
}

function restartGame() {
  striker.x = 200; striker.y = 360; striker.vx=0; striker.vy=0;
  initPucks();
  document.getElementById('winMessage').style.display='none';
}

canvas.addEventListener('mousedown', e=>{
  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left, y = e.clientY - rect.top;
  if (Math.hypot(x - striker.x, y - striker.y) < striker.r+10) {
    dragging = true;
    dragStart = {x, y};
  }
});
canvas.addEventListener('mouseup', e=>{
  if (dragging) {
    const dx = dragStart.x - striker.x;
    const dy = dragStart.y - striker.y;
    const len = Math.hypot(dx, dy);
    striker.vx = (dx/len)*power;
    striker.vy = (dy/len)*power;
    document.getElementById('strikeSound').play();
  }
  dragging=false;
});
canvas.addEventListener('mousemove', e=>{
  if (dragging) {
    const rect = canvas.getBoundingClientRect();
    dragStart = {x: e.clientX - rect.left, y: e.clientY - rect.top};
  }
});

function draw() {
  ctx.clearRect(0,0,400,400);
  // draw pockets
  [0,400].forEach(x=>[0,400].forEach(y=>{
    ctx.beginPath();
    ctx.arc(x,y,15,0,Math.PI*2);
    ctx.fillStyle='#000'; ctx.fill();
  }));
  // draw pucks
  pucks.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle=p.color; ctx.fill();
  });
  // draw striker
  ctx.beginPath();
  ctx.arc(striker.x,striker.y,striker.r,0,Math.PI*2);
  ctx.fillStyle='navy'; ctx.fill();

  // aiming line
  if (dragging) {
    ctx.beginPath();
    ctx.moveTo(striker.x,striker.y);
    ctx.lineTo(dragStart.x,dragStart.y);
    ctx.strokeStyle='yellow';
    ctx.stroke();
    // extra: line to nearest puck
    const target = pucks[0];
    ctx.beginPath();
    ctx.moveTo(striker.x,striker.y);
    ctx.lineTo(target.x,target.y);
    ctx.strokeStyle='red';
    ctx.stroke();
  }
}

function physics() {
  striker.x += striker.vx; striker.y += striker.vy;
  striker.vx*=0.98; striker.vy*=0.98;
  pucks.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy;
    p.vx*=0.98; p.vy*=0.98;
  });

  // collisions
  pucks.forEach(p=>{
    const dx = striker.x - p.x, dy = striker.y - p.y;
    const dist = Math.hypot(dx, dy);
    if (dist < striker.r + p.r) {
      // simple elastic
      const angle = Math.atan2(dy, dx);
      const speed = Math.hypot(striker.vx,striker.vy);
      p.vx = Math.cos(angle)*speed; p.vy = Math.sin(angle)*speed;
      striker.vx*=-0.5; striker.vy*=-0.5;
    }
  });

  // check pocket
  pucks = pucks.filter(p=>{
    if ([0,400].some(px=>[0,400].some(py=>Math.hypot(p.x-px,p.y-py)<15))){
      document.getElementById('pocketSound').play();
      return false;
    }
    return true;
  });

  // win
  if (pucks.length==0) {
    document.getElementById('winMessage').style.display='block';
    document.getElementById('winSound').play();
  }

  // bounds
  striker.x=Math.max(striker.r,Math.min(400-striker.r,striker.x));
  striker.y=Math.max(striker.r,Math.min(400-striker.r,striker.y));
}

function loop() {
  physics(); draw();
  requestAnimationFrame(loop);
}

restartGame();
loop();
</script>

</body>
</html>
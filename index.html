<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Mini Carrom Game</title>
<style>
  body {
    margin: 0;
    background: #deb887;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    color: #4b2e2e;
    margin: 10px;
  }
  canvas {
    background: #ffe4b5;
    border: 10px solid #8b4513;
    border-radius: 5px;
  }
  #score {
    font-size: 1.2em;
    margin: 5px;
    color: #4b2e2e;
  }
</style>
</head>
<body>

<h1>ðŸŽ± Mini Carrom Game ðŸŽ±</h1>
<div id="score">Score: 0</div>
<canvas id="canvas" width="400" height="400"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');

let striker = { x: 200, y: 350, radius: 12, dx:0, dy:0, color:'navy' };
let coins = [];

// Add queen
coins.push({ x:200, y:200, radius:10, dx:0, dy:0, color:'red' });

// Add 9 white & 9 black coins
for(let i=0;i<9;i++){
  coins.push({ x:180+Math.random()*40, y:180+Math.random()*40, radius:10, dx:0, dy:0, color:'white' });
  coins.push({ x:180+Math.random()*40, y:180+Math.random()*40, radius:10, dx:0, dy:0, color:'#2f2f2f' });
}

let allBalls = [striker, ...coins];
let score = 0;

let aiming = false;
let aimX=0, aimY=0;

canvas.onmousedown = e => { aiming = true; aimX=e.offsetX; aimY=e.offsetY; };
canvas.onmouseup = e => {
  if(aiming){
    aiming=false;
    let dx = e.offsetX - striker.x;
    let dy = e.offsetY - striker.y;
    striker.dx = dx*0.2;
    striker.dy = dy*0.2;
  }
};

function collide(b1, b2){
  let dx=b2.x-b1.x;
  let dy=b2.y-b1.y;
  let dist=Math.hypot(dx,dy);
  let minDist=b1.radius+b2.radius;
  if(dist<minDist && dist>0){
    let overlap = (minDist - dist) / 2;
    let nx = dx/dist;
    let ny = dy/dist;
    b1.x -= nx*overlap;
    b1.y -= ny*overlap;
    b2.x += nx*overlap;
    b2.y += ny*overlap;

    // swap velocities
    let vx=b1.dx - b2.dx;
    let vy=b1.dy - b2.dy;
    let dot= vx*nx + vy*ny;
    b1.dx -= dot*nx;
    b1.dy -= dot*ny;
    b2.dx += dot*nx;
    b2.dy += dot*ny;
  }
}

function update() {
  allBalls.forEach(ball=>{
    ball.x += ball.dx;
    ball.y += ball.dy;
    ball.dx *=0.98;
    ball.dy *=0.98;
    if(Math.abs(ball.dx)<0.05) ball.dx=0;
    if(Math.abs(ball.dy)<0.05) ball.dy=0;

    // Wall collision
    if(ball.x - ball.radius < 0){ ball.x=ball.radius; ball.dx=-ball.dx; }
    if(ball.x + ball.radius > 400){ ball.x=400-ball.radius; ball.dx=-ball.dx; }
    if(ball.y - ball.radius < 0){ ball.y=ball.radius; ball.dy=-ball.dy; }
    if(ball.y + ball.radius > 400){ ball.y=400-ball.radius; ball.dy=-ball.dy; }
  });

  // Collisions between all coins
  for(let i=0;i<allBalls.length;i++){
    for(let j=i+1;j<allBalls.length;j++){
      collide(allBalls[i], allBalls[j]);
    }
  }

  // Check pockets
  let pockets = [[0,0],[400,0],[0,400],[400,400]];
  coins = coins.filter(c=>{
    let pocketed=false;
    pockets.forEach(p=>{
      if(Math.hypot(c.x-p[0],c.y-p[1])<20){ pocketed=true; score+=1; }
    });
    return !pocketed;
  });
  allBalls = [striker, ...coins];
  scoreEl.innerText="Score: "+score;
}

function draw(){
  ctx.clearRect(0,0,400,400);
  // Draw pockets
  ctx.fillStyle='black';
  [[0,0],[400,0],[0,400],[400,400]].forEach(p=>{
    ctx.beginPath();
    ctx.arc(p[0],p[1],20,0,Math.PI*2);
    ctx.fill();
  });
  // Draw coins
  coins.forEach(c=>{
    ctx.beginPath();
    ctx.arc(c.x,c.y,c.radius,0,Math.PI*2);
    ctx.fillStyle=c.color;
    ctx.fill();
  });
  // Draw striker
  ctx.beginPath();
  ctx.arc(striker.x,striker.y,striker.radius,0,Math.PI*2);
  ctx.fillStyle=striker.color;
  ctx.fill();

  // Aiming line
  if(aiming){
    ctx.strokeStyle='blue';
    ctx.beginPath();
    ctx.moveTo(striker.x,striker.y);
    ctx.lineTo(aimX,aimY);
    ctx.stroke();
  }
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>